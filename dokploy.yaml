name: curriculum-backend

app:
  type: container
  image: ${REGISTRY_URL}/${IMAGE_NAME}:${IMAGE_TAG}

env:
  - SECRET_KEY
  - DEBUG
  - URL_SERVER
  - ALLOWED_HOSTS
  - RECAPTCHA_PUBLIC_KEY
  - RECAPTCHA_PRIVATE_KEY
  - EMAIL_HOST
  - EMAIL_PORT
  - EMAIL_HOST_USER
  - EMAIL_HOST_PASSWORD
  - DEFAULT_FROM_EMAIL

resources:
  cpu: 1
  memory: 1Gi

networking:
  port: 8000
  domains:
    - domain: backend.yampi.eu
      path: /

volumes:
  - name: media-files
    mountPath: /app/media
    size: 2Gi
  - name: static-files
    mountPath: /app/static
    size: 1Gi
  - name: sqlite-db
    mountPath: /app/db.sqlite3
    size: 100Mi

hooks:
  predeploy:
    command: bash -c "echo 'â–¶ Ejecutando pipeline...' && bash /app/pipeline.sh"

health:
  path: /admin/login/
  initialDelaySeconds: 30
  periodSeconds: 60
  timeoutSeconds: 5
  successThreshold: 1
  failureThreshold: 3

scaling:
  min: 1
  max: 1
